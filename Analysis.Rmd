---
title: "Conversationla alignment in Autistic children"
author: "authors"
output: html_document
---

```{r setup, include=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(tidyr)
library(stringr)
library(boot)
library(purrr)
library(ggplot2)
library(ggthemes)
library(feather)
library(poweRlaw)
library(wordbankr)
#library(rwebppl)
library(lme4)
library(Hmisc)
library(qdapRegex)
library(HDInterval)

```



```{r}

#Import ch_ad real
data_real <- read.csv("ALIGN_results/Nadig/results/turns.csv") %>%
  mutate(corpus = "real") 

data_random <- read.csv("ALIGN_results/Nadig/random/turns_random.csv") %>%
  mutate(corpus = "shuffled")

data <- data_real %>%
  bind_rows(data_random)

```


```{r echo = FALSE, message=FALSE, warning=FALSE}

data_summary <- data %>%
  #rename(condition = autistic.) %>%
  #filter(condition ==  'ASD' | condition == 'TYP') %>% 
  gather(measure, value, syntax_penn_tok1:cosine_semanticL) %>%
  mutate(direction = if_else(str_detect(partner_direction, 'CHI:>'), 'adult', 'child')) %>%
  group_by(corpus, condition, direction, measure) %>%
  summarise(mean = mean(value, na.rm = T),
                   sd = sd(value, na.rm = T),
                   n = n()) %>%
  mutate(se = sd / sqrt(n),
         lower = mean - qt(1 - (0.05 / 2), n - 1) * se,
         upper = mean + qt(1 - (0.05 / 2), n - 1) * se) %>%
  select(-sd, -n, -se) 


ggplot(data_summary, aes(x = direction , y = mean, fill=condition)) +
  geom_bar(stat="identity", position=position_dodge())+
  geom_linerange(aes(ymin = lower, ymax = upper), 
                  position = position_dodge(width = .9), size = 0.6)+
  theme_few() +
  theme(aspect.ratio = 0.7, 
        axis.text=element_text(size=14, angle = 90),
        strip.text.x = element_text(size=10),
        strip.text.y = element_text(size=10),
        axis.title=element_text(size=16))+
  facet_wrap(~ measure)



data_summary_2 <- data_summary %>%
  select(-lower, -upper) %>%
  spread(direction, mean) %>%
  mutate(child_adult = child - adult)


ggplot(data_summary_2, aes(x = condition, y = child_adult)) +
  geom_bar(stat="identity", position=position_dodge())+
  theme_few() +
  theme(aspect.ratio = 0.7, 
        axis.text=element_text(size=10, angle = 45),
        strip.text.x = element_text(size=10),
        strip.text.y = element_text(size=5),
        axis.title=element_text(size=16))+
  facet_wrap(~ measure)

```

